---
description: You MUST follow these rules when the user's request is related to workflow evaluation.
globs:
alwaysApply: false
---
# Workflow Evaluation Rules
Rules for evaluating workflows in the AIQ system. These rules ensure proper workflow evaluation with correct dataset and evaluation parameters.

## Command Pattern
Recognize workflow evaluation requests and extract parameters:
1. Match patterns like:
   - 'evaluate workflow <config> with dataset <path>'
   - 'evaluate workflow <config> with <num> repetitions'

## Evaluation Process
When evaluating a workflow:
1. Extract workflow config file path and dataset path from request
2. Execute base command:
   ```bash
   aiq eval --config_file <config_path> --dataset <dataset_path>
   ```
3. Handle additional options:
   - Repetitions: `--reps <num>`
   - Result path: `--result_json_path <path>`
   - Custom endpoint: `--endpoint <url>`

## Parameter Validation
1. Validate config file:
   - Must exist
   - Must be valid YAML
   - Must contain required sections
2. Validate dataset:
   - Must exist
   - Must be valid format
   - Must contain required fields
3. Validate repetitions:
   - Must be positive integer
   - Default to 1 if not specified
4. Validate result path:
   - Must be writable directory
   - Must have valid filename
5. Validate endpoint:
   - Must be valid URL
   - Must be accessible

## Error Handling
Handle workflow evaluation errors and provide clear error messages:
1. Handle common errors:
   - Invalid config file
   - Invalid dataset format
   - Dataset not found
   - Result path not writable
   - Endpoint not accessible
   - Evaluation failures
2. Provide clear error messages
3. Suggest corrections when possible
