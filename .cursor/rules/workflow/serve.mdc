---
description: You MUST follow these rules when the user's request is related to workflow serving.
globs:
alwaysApply: false
---
# Workflow Serving Rules

## Overview
Rules for serving workflows in the AIQ system. These rules ensure proper workflow serving with correct host, port, and worker configurations.

## Command Structure
```bash
aiq serve --config_file <config_path> [--host <host>] [--port <port>] [--workers <num>] [--reload true]
```

### Required Parameters
- `--config_file <config_path>`: Path to workflow configuration file
  - Must exist
  - Must be valid YAML
  - Must contain required sections

### Optional Parameters
- `--host <host>`: Custom host to serve on
  - Must be valid hostname or IP
  - Defaults to localhost if not specified
- `--port <port>`: Custom port to serve on
  - Must be valid port number
  - Must be available
  - Defaults to 8000 if not specified
- `--workers <num>`: Number of worker processes
  - Must be positive integer
  - Defaults to 1 if not specified
- `--reload true`: Enable auto-reload on file changes

## Natural Language Processing
- Match patterns like:
  - 'serve workflow <config>'
  - 'serve workflow <config> on host <host> port <port>'
  - 'serve workflow <config> with <num> workers'

## Serving Process
1. Extract workflow config file path and options from request
2. Execute base command with extracted parameters
3. For multiple options, combine them in a single command:
   ```bash
   aiq serve --config_file <config_path> --host <host> --port <port> --workers <num> --reload true
   ```

## Error Handling
1. Common errors to handle:
   - Invalid config file
   - Port already in use
   - Invalid host configuration
   - Worker initialization failures
   - Server startup failures
2. Provide clear error messages
3. Suggest corrections when possible
